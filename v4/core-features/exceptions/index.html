<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="description" content="DotKernel API">
        
        

        
        
            
        
        <meta name="docsearch:version" content="4.0.0,latest">
        <meta name="docsearch:language" content="en">
        <meta name="docsearch:component" content="api">

        
        <link rel="canonical" href="https://docs.dotkernel.org/api-documentation/v4/core-features/exceptions/">
        
        <link rel="shortcut icon" href="https://docs.dotkernel.org/img/dk_docs_favicon_white.svg">

        <title>Exceptions - api - DotKernel Documentation</title>

        <link rel="stylesheet" href="https://docs.dotkernel.org/css/bootstrap.css">
        <link rel="stylesheet" href="https://docs.dotkernel.org/css/bootstrap-icons.min.css">
        <link rel="stylesheet" href="https://docs.dotkernel.org/css/docs.css">
        <script src="https://docs.dotkernel.org//js/bootstrap.js" defer></script>
        <script src="https://docs.dotkernel.org//js/docs.js" defer></script>
        <script src="https://docs.dotkernel.org//js/scripts.js" defer></script>
    </head>
    <body data-bs-spy="scroll" data-bs-target=".toc" data-bs-offset="100">

        
        <nav class="navbar navbar-expand-lg bg-body-tertiary bg-light dk-nav py-3" data-bs-theme="light">
    <div class="container justify-content-between">
        <div class="dk-nav-icon d-flex align-items-center">
            <a class="navbar-brand" href="https://docs.dotkernel.org/">
                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50"
                     src="https://docs.dotkernel.org//img/dk_logomark_white.svg" width="45"/>
            </a>

            <div class="dk-nav-icon-items">
                <span style="font-size: 12px; line-height: 13px">DotKernel Documentation</span>

                <div class="dropdown" data-bs-theme="light">
                    <span class="fw-bold dropdown-toggle dk-pkg-name" data-bs-toggle="dropdown" aria-expanded="false">API</span>
                    <ul class="dropdown-menu">
                        
                        <li class="dropdown-item bg-light">
                            <a href="https://docs.dotkernel.org/api-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">API</span>
                                    <span>DotKernel API</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/admin/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Admin</span>
                                    <span>DotKernel Admin application</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/frontend/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Frontend</span>
                                    <span>DotKernel Frontend application</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/packages/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Packages</span>
                                    <span>DotKernel packages</span>
                                </div>
                            </a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
<!--                <li class="nav-item">-->
<!--                    <a href="#" class="nav-link fw-bold text-white" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal" title="Open search">-->
<!--                        <i class="bi bi-search"></i> Search-->
<!--                    </a>-->
<!--                </li>-->
                <li class="nav-item">
                    <a class="nav-link fw-bold text-white" href="https://github.com/dotkernel/api" title="Go to api repository" target="_blank">
                        <i class="bi bi-github"></i>
                        GitHub
                    </a>
                </li>
                <li class="nav-item">
                    
                </li>
            </ul>
        </div>
    </div>
</nav>

        
        <div class="container">
    <nav aria-label="breadcrumb" class="nav_breadcrumb">
        <ol class="breadcrumb">
            
                <li class="breadcrumb-item"><a href="https://docs.dotkernel.org/">Overview</a></li>
                <li class="breadcrumb-item"><a href="">API</a></li>

                
                    <li class="breadcrumb-item"><a href="../../..">api</a></li>

                    
                        
                            
                            
                        
                    
                        
                            
                            
                                <li class="breadcrumb-item">Core Features</li>
                            
                        
                    

                    <li class="breadcrumb-item active" aria-current="page">Exceptions</li>
                
            
        </ol>
    </nav>
</div>

        
        <div class="container">
            <div class="row">
                <div class="col-lg-3 right_sidebar">
                    
                    
    <div class="subnavigation hidden-print">
<!--        <h4 class="subnavigation__title">-->
<!--            <a href="../../..">api</a>-->
<!--        </h4>-->

        <h5 class="subnavigation__title">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                
                    
                        



























<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#introduction" role="button" aria-expanded="false" aria-controls="introduction">
        <span class="subnavigation__headline">Introduction</span>
    </a>
    <ul class="subnavigation__list collapse" id="introduction">
        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/introduction/" class="subnavigation__link">Introduction</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/server-requirements/" class="subnavigation__link">Server Requirements</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/file-structure/" class="subnavigation__link">File Structure</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/packages/" class="subnavigation__link">Packages</a>
</li>

        
    </ul>
</li>

                    
                        



























<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#installation" role="button" aria-expanded="false" aria-controls="installation">
        <span class="subnavigation__headline">Installation</span>
    </a>
    <ul class="subnavigation__list collapse" id="installation">
        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/getting-started/" class="subnavigation__link">Getting Started</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/composer/" class="subnavigation__link">Composer</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/configuration-files/" class="subnavigation__link">Configuration Files</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/doctrine-orm/" class="subnavigation__link">Doctrine ORM</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/test-the-installation/" class="subnavigation__link">Test the Installation</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/faq/" class="subnavigation__link">FAQ</a>
</li>

        
    </ul>
</li>

                    
                        











<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#flow" role="button" aria-expanded="false" aria-controls="flow">
        <span class="subnavigation__headline">Flow</span>
    </a>
    <ul class="subnavigation__list collapse" id="flow">
        
        
<li class="subnavigation__list-item ">
    <a href="../../flow/middleware-flow/" class="subnavigation__link">Middleware Flow</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../flow/default-library-flow/" class="subnavigation__link">Default Library Flow</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../flow/library-flow-for-email/" class="subnavigation__link">Library Flow for Email</a>
</li>

        
    </ul>
</li>

                    
                        





























<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#core-features" role="button" aria-expanded="false" aria-controls="core-features">
        <span class="subnavigation__headline">Core Features</span>
    </a>
    <ul class="subnavigation__list collapse" id="core-features">
        
        
<li class="subnavigation__list-item ">
    <a href="../content-validation/" class="subnavigation__link">Content Validation</a>
</li>

        
        
<li class="subnavigation__list-item subnavigation__list-item--active">
    <a href="./" class="subnavigation__link">Exceptions</a>
</li>

        
    </ul>
</li>

                    
                        





















<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#tutorials" role="button" aria-expanded="false" aria-controls="tutorials">
        <span class="subnavigation__headline">Tutorials</span>
    </a>
    <ul class="subnavigation__list collapse" id="tutorials">
        
        
<li class="subnavigation__list-item ">
    <a href="../../tutorials/create-book-module/" class="subnavigation__link">Creating a book module</a>
</li>

        
    </ul>
</li>

                    
                        





















































<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#transition-from-api-tools" role="button" aria-expanded="false" aria-controls="transition-from-api-tools">
        <span class="subnavigation__headline">Transition from API Tools</span>
    </a>
    <ul class="subnavigation__list collapse" id="transition-from-api-tools">
        
        
<li class="subnavigation__list-item ">
    <a href="../../transition-from-api-tools/api-tools-vs-dotkernel-api/" class="subnavigation__link">Laminas API Tools vs DotKernel API</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../transition-from-api-tools/transition-approach/" class="subnavigation__link">Transition Approach</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../transition-from-api-tools/discovery-phase/" class="subnavigation__link">Discovery Phase</a>
</li>

        
    </ul>
</li>

                    
                
            
        </ul>
    </div>

                    

                    
                    
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
            
                <li class="toc__entry">
                    <a href="#what-are-exceptions" class="toc__link nav-link">What are exceptions?</a>
                </li>
            
                <li class="toc__entry">
                    <a href="#how-we-use-exceptions" class="toc__link nav-link">How we use exceptions?</a>
                </li>
            
                <li class="toc__entry">
                    <a href="#how-it-works" class="toc__link nav-link">How it works?</a>
                </li>
            
                <li class="toc__entry">
                    <a href="#how-to-extend" class="toc__link nav-link">How to extend?</a>
                </li>
            
            </ul>
        </div>
    

                    
                </div>
                <div class="col-lg-9 main_docs">
                    
                    




    
    
<!--        <h2 class="chapter__headline text-black-50">Core Features</h2>-->
    

    <h1 id="exceptions">Exceptions</h1>
<h2 id="what-are-exceptions">What are exceptions?</h2>
<p>Exceptions are a powerful mechanism for handling errors and other exceptional conditions that may occur during the
execution of a script.
They provide a way to manage errors in a structured and controlled manner, separating error-handling code from regular
code.</p>
<h2 id="how-we-use-exceptions">How we use exceptions?</h2>
<p>When it comes to handling exceptions, <strong>DotKernel API</strong> relies on the usage of easy-to-understand, problem-specific
exceptions.</p>
<p>Out-of-the-box we provide the following custom exceptions:</p>
<h3 id="badrequestexception-thrown-when"><code>BadRequestException</code> thrown when</h3>
<ul>
<li>client tries to create/update resource, but the data from the request is invalid/incomplete (example: client tries to
  create an account, but does not send the required <code>identity</code> field)</li>
</ul>
<h3 id="conflictexception-thrown-when"><code>ConflictException</code> thrown when</h3>
<ul>
<li>resource cannot be created because a different resource with the same identifier already exists (example: cannot
  change existing user's identity because another user with the same identity already exists)</li>
<li>resource cannot change its state because it is already in the specified state (example: user cannot be activated
  because it is already active)</li>
</ul>
<h3 id="expiredexception-thrown-when"><code>ExpiredException</code> thrown when</h3>
<ul>
<li>resource cannot be accessed because it expired (example: account activation link)</li>
<li>resource cannot be accessed because it has been consumed (example: one-time password)</li>
</ul>
<h3 id="forbiddenexception-thrown-when"><code>ForbiddenException</code> thrown when</h3>
<ul>
<li>resource cannot be accessed by the authenticated client (example: client authenticated as regular user sends
  a <code>GET /admin</code> request)</li>
</ul>
<h3 id="methodnotallowedexception-thrown-when"><code>MethodNotAllowedException</code> thrown when</h3>
<ul>
<li>client tries to interact with a resource via an invalid HTTP request method (example: client sends a <code>PATCH /avatar</code>
  request)</li>
</ul>
<h3 id="notfoundexception-thrown-when"><code>NotFoundException</code> thrown when</h3>
<ul>
<li>client tries to interact with a resource that does not exist on the server (example: client sends
  a <code>GET /resource-does-not-exist</code> request)</li>
</ul>
<h3 id="unauthorizedexception-thrown-when"><code>UnauthorizedException</code> thrown when</h3>
<ul>
<li>resource cannot be accessed because the client is not authenticated (example: unauthenticated client sends
  a <code>GET /admin</code> request)</li>
</ul>
<h2 id="how-it-works">How it works?</h2>
<p>During a request, if there is no uncaught exception <strong>DotKernel API</strong> will return a JSON response with the data provided
by the handler that handled the request.</p>
<p>Else, it will build and send a response based on the exception thrown:</p>
<ul>
<li><code>BadRequestException</code> will return a <code>400 Bad Request</code> response</li>
<li><code>UnauthorizedException</code> will return a <code>401 Unauthorized</code> response</li>
<li><code>ForbiddenException</code> will return a <code>403 Forbidden</code> response</li>
<li><code>OutOfBoundsException</code> and <code>NotFoundException</code> will return a <code>404 Not Found</code> response</li>
<li><code>MethodNotAllowedException</code> will return a <code>405 Method Not Allowed</code> response</li>
<li><code>ConflictException</code> will return a <code>409 Conflict</code> response</li>
<li><code>ExpiredException</code> will return a <code>410 Gone</code> response</li>
<li><code>MailException</code>, <code>RuntimeException</code> and the generic <code>Exception</code> will return a <code>500 Internal Server Error</code> response</li>
</ul>
<h2 id="how-to-extend">How to extend?</h2>
<p>In this example we will create a custom exception called <code>CustomException</code>, place it next to the already existing custom
exceptions (you can use your preferred location) and finally return a custom HTTP status code when <code>CustomException</code> is
encountered.</p>
<h3 id="step-1-create-exception-file">Step 1: Create exception file</h3>
<p>Navigate to the directory <code>src/App/src/Handler/Exception</code> and create a PHP class called <code>CustomException.php</code>.
Open <code>CustomException.php</code> and add the following content:</p>
<pre class="highlight"><code class="language-php">&lt;?php

declare(strict_types=1);

namespace Api\App\Exception;

use Exception;

class CustomException extends Exception
{
}</code></pre>
<p>Save and close the file.</p>
<h3 id="step-2-use-exception-file">Step 2: Use exception file</h3>
<p>Open the file <code>src/App/src/Handler/HomeHandler.php</code> and at the beginning of the <code>get</code> method, place the following code:</p>
<pre class="highlight"><code class="language-php">throw new \Api\App\Exception\CustomException('some message');</code></pre>
<p>Save and close the file.</p>
<h3 id="step-3-test-for-failure">Step 3: Test for failure</h3>
<p>Access your API's home page URL and make sure it returns <code>500 Internal Server Error</code> HTTP status code and the following
content:</p>
<pre class="highlight"><code class="language-json">{
    "error": {
        "messages": [
            "some message"
        ]
    }
}</code></pre>
<h3 id="step-4-prepare-for-success">Step 4: Prepare for success</h3>
<p>Open the file <code>src/App/src/Handler/ResponseTrait.php</code> and locate the <code>handle</code> method.
Insert the following lines of code before the first catch statement:</p>
<pre class="highlight"><code class="language-php">        } catch (\Api\App\Exception\CustomException $exception) {
            return $this-&gt;errorResponse($exception-&gt;getMessage(), StatusCodeInterface::STATUS_IM_A_TEAPOT);</code></pre>
<p>Save and close the file.</p>
<h3 id="step-5-test-for-success">Step 5: Test for success</h3>
<p>Again, access your API's home page URL, which should return the same content.
Notice that this time it returns <code>418 I'm a teapot</code> HTTP status code.</p>




    <nav>
    <ul class="page-nav hidden-print">
        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../content-validation/">
                    <small class="page-nav__label">Previous</small>
                    <i class="bi bi-chevron-left"></i>
                    Content Validation
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../../tutorials/create-book-module/">
                    <small class="page-nav__label">Next</small>
                    Creating a book module
                    <i class="bi bi-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                    
                </div>
            </div>
        </div>

        
        <footer class="footer">
    <div class="container">

        <div class="row">
            <div class="col-md-9">
                <div class="footer_head">
                    <p>DotKernel</p>
                </div>

                <div class="row">
                    <div class="col-md-6 dk_widget">
                        <p>DotKernel Frontend</p>
                        <a href="https://docs.dotkernel.org/frontend/" target="_blank">
                            <i class="bi bi-arrow-return-right"></i>
                            DotKernel web starter project suitable for frontend applications
                        </a>
                    </div>

                    <div class="col-md-6 dk_widget">
                        <p>DotKernel API</p>
                        <a href="https://docs.dotkernel.org/api-documentation/" target="_blank">
                            <i class="bi bi-arrow-return-right"></i>
                            DotKernel web starter project suitable for building RESTful APIs
                        </a>
                    </div>

                    <div class="col-md-6 dk_widget">
                        <p>DotKernel Admin</p>

                        <a href="https://docs.dotkernel.org/admin/" target="_blank">
                            <i class="bi bi-arrow-return-right"></i>
                            DotKernel web starter project suitable for admin applications
                        </a>
                    </div>

                    <div class="col-md-6 dk_widget">
                        <p>DotKernel Packages</p>
                        <a href="https://docs.dotkernel.org/packages/" target="_blank">
                            <i class="bi bi-arrow-return-right"></i>
                            DotKernel packages offering a wide range of tools
                        </a>
                    </div>
                </div>

            </div>

            <div class="col-md-3">
                <div class="footer_head">
                    <p>Support</p>
                </div>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://github.com/dotkernel" class="support__link" title="GitHub" target="_blank">
                            <i class="bi bi-github"></i> GitHub
                        </a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://dotkernel.slack.com" class="support__link" title="Slack" target="_blank">
                            <i class="bi bi-slack"></i> Slack
                        </a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/dotkernel" class="support__link" title="X (Twitter)" target="_blank">
                            <i class="bi bi-twitter-x"></i> Twitter
                        </a>
                    </li>

                    <li class="support__list-item">
                        <a href="https://www.dotkernel.com/blog/" class="support__link" title="Blog" target="_blank">
                            <i class="bi bi-file-post"></i> Blog
                        </a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://www.dotkernel.com/feed/" class="support__link" title="Blog feed" target="_blank">
                            <i class="bi bi-rss-fill"></i> Feed
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="footer_copy">
            &#169; 2024 by <a href="https://www.dotkernel.com/" target="_blank">DotKernel</a> a collection of PSR-7 Middleware applications and libraries
        </div>
    </div>
</footer>

        <script>
            let base_url = '../../..',
                project  = "api",
                siteName = 'api';

                document.addEventListener("DOMContentLoaded", function() {
                    document.querySelectorAll('.subnavigation__link').forEach(function(link) {
                        if (link.getAttribute('href') === './') {
                            link.parentNode.parentNode.classList.add('show');
                        }
                    });
                });
        </script>
<!--        -->
<!--        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in api" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>-->
    </body>
</html>
